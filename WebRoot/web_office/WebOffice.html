<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf8" />
<title>WebOffice演示程序</title>
<style type="text/css">
<!--
.topSide {
	border-top-width: 1px;
	border-right-width: 1px;
	border-bottom-width: 1px;
	border-left-width: 1px;
	border-top-style: solid;
	border-top-color: #3366CC;
	border-right-color: #3366CC;
	border-bottom-color: #3366CC;
	border-left-color: #3366CC;
}
.leftBorder {
	border-top-width: 1px;
	border-right-width: 1px;
	border-bottom-width: 1px;
	border-left-width: 1px;
	border-left-style: dashed;
	border-left-color: #0066FF;
}
.downSide {
	border-top-width: 1px;
	border-right-width: 1px;
	border-bottom-width: 1px;
	border-left-width: 1px;
	border-bottom-style: dashed;
	border-bottom-color: #0066FF;
}
.STYLE1 {color: #FF0000}
-->
</style>
<!-- --------------------=== 调用Weboffice初始化方法 ===--------------------- -->
<SCRIPT LANGUAGE="javascript" FOR="WebOffice1" EVENT="NotifyCtrlReady">
	WebOffice1_NotifyCtrlReady();			// 在装载完Weboffice(执行<object>...</object>)控件后执行 "WebOffice1_NotifyCtrlReady"方法
</SCRIPT>
<SCRIPT LANGUAGE=javascript>
<!--
// ---------------------=== 控件初始化WebOffice方法 ===---------------------- //
function WebOffice1_NotifyCtrlReady() {
		document.getElementById('WebOffice1').LoadOriginalFile("", "doc");
}
// ---------------------=== 新建文档 ===---------------------- //
function newDoc() {
		var doctype=document.getElementById('doctype').value;
		document.getElementById('WebOffice1').LoadOriginalFile("", doctype);
}
// ---------------------=== 显示打印对话框 ===---------------------- //
function showPrintDialog(){
		document.getElementById('WebOffice1').PrintDoc(1);
}
// ---------------------=== 直接打印 ===---------------------- //
function zhiPrint(){
		document.getElementById('WebOffice1').PrintDoc(0);
}
// ---------------------== 关闭页面时调用此函数，关闭文件 ==---------------------- //
function window_onunload() {
	document.getElementById('WebOffice1').Close();
}
 
// ---------------------------== 解除文档保护 ==---------------------------------- //
function UnProtect() {
	document.getElementById('WebOffice1').ProtectDoc(0,1, document.all.docPwd.value);
}

// ---------------------------== 设置文档保护 ==---------------------------------- //
function ProtectFull() {
	document.getElementById('WebOffice1').ProtectDoc(1,1, document.all.docPwd.value);
}
// ---------------------------== 禁止打印 ==---------------------------------- //
function notPrint() {
		document.getElementById('WebOffice1').SetSecurity(0x01); 
}
// ---------------------------== 恢复允许打印 ==---------------------------------- //
function okPrint() {
		document.getElementById('WebOffice1').SetSecurity(0x01 + 0x8000);

}
// ---------------------------== 禁止保存 ==---------------------------------- //
function notSave() {
		document.getElementById('WebOffice1').SetSecurity(0x02); 

}
// ---------------------------== 恢复允许保存 ==---------------------------------- //
function okSave() {
		document.getElementById('WebOffice1').SetSecurity(0x02 + 0x8000);

}
// ---------------------------== 禁止复制 ==---------------------------------- //
function notCopy() {
		document.getElementById('WebOffice1').SetSecurity(0x04); 
}
// ---------------------------== 恢复允许复制 ==---------------------------------- //
function okCopy() {
		document.getElementById('WebOffice1').SetSecurity(0x04 + 0x8000); 

}
// ---------------------------== 禁止拖动 ==---------------------------------- //
function notDrag() {
		document.getElementById('WebOffice1').SetSecurity(0x08); 
}
// ---------------------------== 恢复拖动 ==---------------------------------- //
function okDrag() {
		document.getElementById('WebOffice1').SetSecurity(0x08 + 0x8000); 

}
// -----------------------------== 修订文档 ==------------------------------------ //
function ProtectRevision() {
	document.getElementById('WebOffice1').SetTrackRevisions(1) 
}

// -----------------------------== 隐藏修订 ==------------------------------------ //
function UnShowRevisions() {
	document.getElementById('WebOffice1').ShowRevisions(0);
}

// --------------------------== 显示当前修订 ==---------------------------------- //
function ShowRevisions() {
	document.getElementById('WebOffice1').ShowRevisions(1);

}

// -------------------------== 接受当前所有修订 ==------------------------------- //
function AcceptAllRevisions() {
 	document.getElementById('WebOffice1').SetTrackRevisions(4);
}

// ---------------------------== 设置当前操作用户 ==------------------------------- //
function SetUserName() {
	if(document.all.UserName.value ==""){
		alert("用户名不可为空")
		document.all.UserName.focus();
		return false;
	}
 	document.getElementById('WebOffice1').SetCurrUserName(document.all.UserName.value);
}
// -------------------------=== 设置书签 ===------------------------------ //
function addBookmark() {
	document.getElementById('WebOffice1').SetFieldValue("mark_1", "北京信息技术有限公司", "::ADDMARK::");			
}

// -------------------------=== 设置书签套加红头 ===------------------------------ //
function addRedHead() {
	document.getElementById('WebOffice1').SetFieldValue("mark_1", "", "::ADDMARK::");			// 添加书签
	document.getElementById('WebOffice1').SetFieldValue("mark_1", "E:\\tem1.doc", "::FILE::");
}
// -------------------------=== 设置书签插入图片 ===------------------------------ //
function addImage() {
	document.getElementById('WebOffice1').SetFieldValue("mark_1", "", "::ADDMARK::");			// 添加书签
	document.getElementById('WebOffice1').SetFieldValue("mark_1", "c:\\image\\logo.gif", "::JPG::");
}


// -----------------------------== 返回首页 ==------------------------------------ //
function return_onclick() {
	document.getElementById('WebOffice1').Close();
	window.location.href  = "index.jsp"
}
// 打开本地文件
function docOpen() {
	document.getElementById('WebOffice1').LoadOriginalFile("open", "doc");
	// document.getElementById('WebOffice1').LoadOriginalFile("open", "doc");
}
// -----------------------------== 保存文档 ==------------------------------------ //
function newSave() {
	document.getElementById('WebOffice1').Save();
}
// -----------------------------== 另存为文档 ==------------------------------------ //
function SaveAsTo() {
	document.getElementById('WebOffice1').ShowDialog(84);
}
// -----------------------------== 隐藏菜单 ==------------------------------------ //
function notMenu() {
	document.getElementById('WebOffice1').SetToolBarButton2("Menu Bar",1,8);
}
// -----------------------------== 显示菜单 ==------------------------------------ //
function okMenu() {
	document.getElementById('WebOffice1').SetToolBarButton2("Menu Bar",1,11);
}
// -----------------------------== 隐藏常用工具栏 ==------------------------------------ //
function notOfter() {
	document.getElementById('WebOffice1').SetToolBarButton2("Standard",1,8);
}
// -----------------------------== 显示常用工具栏 ==------------------------------------ //
function okOfter() {
	document.getElementById('WebOffice1').SetToolBarButton2("Standard",1,11);
}
// -----------------------------== 隐藏格式工具栏 ==------------------------------------ //
function notFormat() {
	document.getElementById('WebOffice1').SetToolBarButton2("Formatting",1,8);
}
// -----------------------------== 显示格式工具栏 ==------------------------------------ //
function okFormat() {
	document.getElementById('WebOffice1').SetToolBarButton2("Formatting",1,11);
} 

function ShowToolBar_onclick()
{
    //通过Document->application->CommandBars 获取到菜单对象
	var vObj = document.getElementById('WebOffice1').GetDocumentObject().Application.CommandBars("电子印章");
	vObj.Visible = !vObj.Visible
}
function AddSeal_onclick()
{
    //通过Document->application->CommandBars 获取到菜单对象
  var vObj = document.getElementById('WebOffice1').GetDocumentObject().Application.CommandBars("电子印章");
	if(vObj) vObj.Controls("盖章").Execute();
}   
//-->
</SCRIPT>
</head>

<body>
<table width="1123" border="0" cellpadding="0" cellspacing="0">
  <!--DWLayoutTable-->

  <tr>
    <td height="15" colspan="4" valign="top" bgcolor="#e5ecf9" class="topSide"><b><strong> DES网页中向WORD盖章</strong></b></td>
    <td></td>
  </tr>
  <tr>
    <td width="20" height="21">&nbsp;</td>
    <td width="44">&nbsp;</td>
    <td width="85">&nbsp;</td>
    <td width="972">&nbsp;</td>
    <td></td>
  </tr>
  <tr>
    <td height="23" colspan="4" valign="top" class="downSide">
	  <font size="-1" >&nbsp;&nbsp;&nbsp;文件格式: </font> 
      <!-- ---------------=== 该处文件格式的value不可以自定义 ===------------------------- -->
		<select name="doctype" size="1" id="doctype">
          <option value="doc">Word</option>
          <option value="xls">Excel</option>
	  <option value="wps">wps</option>
      </select>
		<input name="CreateFile" type="button" id="CreateFile" value="新建文档" onclick="newDoc()">
            <span class="STYLE1">|</span>
      <input name="button" type="button" onclick="return docOpen()" value="打开本地文件" />
    <span class="STYLE1">|  </span><font size="-1">打印:</font>
	<input name="CreateFile" type="button" id="showPrint" value="显示对话框" onclick="showPrintDialog()">
	<input name="CreateFile" type="button" id="zhiPrint" value="直接打印" onclick="zhiPrint()">
	<span class="STYLE1">| </span><font size="-1" >保存:</font>
	<input name="CreateFile2" type="button" id="CreateFile2" value="保存" onclick="newSave()" />
	<input name="CreateFile3" type="button" id="CreateFile3" value="另存为" onclick="SaveAsTo()" />
	<span class="STYLE1"> | </span>
	<INPUT name="ShowToolBar" type=button id="ShowToolBar" onClick="return ShowToolBar_onclick()" value="印章工具栏" >
	<INPUT name="AddSeal" type=button id="AddSeal" onClick="return AddSeal_onclick()" value="盖章" >
	<br /></td>
    <td></td>
  </tr>
  
  <tr>
    <td height="63">&nbsp;</td>
    <td colspan="2" align="center" valign="top" class="downSide">
     <font size="-2" >用户名：</font>
	  <br />
        <input name="UserName" type="text" value="Test" style="width:74px;" maxlength="10" />
        <br />
        <input name="button2" type="button" class="btn"  onclick="return SetUserName()" value="设置用户" />    </td>
  <td colspan="2" rowspan="12" valign="top" class="leftBorder">
      <!-- -----------------------------== 装载weboffice控件 ==--------------------------------- -->
    <OBJECT id="WebOffice1" height="900px" width="100%" style="LEFT: 0px; TOP: 0px" classid="clsid:E77E049B-23FC-4DB8-B756-60529A35FAD5" codebase="weboffice_v6.0.5.0.cab">
		<PARAM NAME="_Version" VALUE="65536">
		<PARAM NAME="_ExtentX" VALUE="2646">
		<PARAM NAME="_ExtentY" VALUE="1323">
		<PARAM NAME="_StockProps" VALUE="0">
	</OBJECT>
    <!-- --------------------------------== 结束装载控件 ==----------------------------------- -->  
  	  
  </td>
  </tr>
  <tr>
    <td height="69">&nbsp;</td>
    <td colspan="2" align="center" valign="top" class="downSide">
				<font size="-2">保护密码：</font><br>
              <input name="docPwd" type="text" value="Password" style="width:74px;" maxlength="10">
              <br>
              <input type="button" class="btn" value="保护文档" onClick="return ProtectFull()">
              <br />
    <input name="button3" type="button" class="btn" onclick="return UnProtect()" value="解除保护" /></td>
  </tr>
  <tr>
    <td height="44">&nbsp;</td>
    <td colspan="2" align="center" valign="top" class="downSide"><input type="button" class="btn" value="禁用打印" onClick="return notPrint()">
      <br />
      <input name="button3" type="button" class="btn" onclick="return okPrint()" value="启用打印" /></td>
  </tr>
  <tr>
    <td height="44">&nbsp;</td>
    <td colspan="2" align="center" valign="top" class="downSide"><input name="button10" type="button" class="btn" onclick="return notSave()" value="禁止保存" />
      <br />
      <input name="button32" type="button" class="btn" onclick="return okSave()" value="允许保存" /></td>
  </tr>
  <tr>
    <td height="44">&nbsp;</td>
    <td colspan="2" align="center" valign="top" class="downSide"><input name="button11" type="button" class="btn" onclick="return notCopy()" value="禁止复制" />
      <br />
      <input name="button33" type="button" class="btn" onclick="return okCopy()" value="允许复制" /></td>
  </tr>
    <tr>
    <td height="44">&nbsp;</td>
    <td colspan="2" align="center" valign="top" class="downSide"><input name="but11" type="button" class="btn" onclick="return notDrag()" value="禁止拖动" />
      <br />
      <input name="but33" type="button" class="btn" onclick="return okDrag()" value="允许拖动" /></td>
  </tr>
  <tr>
    <td height="86">&nbsp;</td>
    <td colspan="2" align="center" valign="top" class="downSide"><input name="button4"  type="button" class="btn" onclick="return ProtectRevision()" value="修订文档" />
      <br />
      <input name="button5" type="button" class="btn" onclick="return ShowRevisions()" value="显示修订" />
      <br />
      <input name="button6" type="button" class="btn" onclick="return UnShowRevisions()" value="隐藏修订" />
      <br />
      <input name="button7" type="button" class="btn" onclick="return AcceptAllRevisions()" value="接受修订" /></td>
  </tr>
  <tr>
    <td height="23">&nbsp;</td>
    <td colspan="2" align="center" valign="top" class="downSide"><input name="button8"  type="button" class="btn" onclick="return addBookmark()" value="设置书签" /></td>
  </tr>
  <tr>
    <td height="23">&nbsp;</td>
    <td colspan="2" align="center" valign="top" class="downSide"><span class="downSide">
      <input name="button9"  type="button" class="btn" onclick="return addRedHead()" value="套加红头" />
    </span></td>
  </tr>
  <tr>
    <td height="23">&nbsp;</td>
    <td colspan="2" align="center" valign="top" class="downSide"><span class="downSide">
      <input name="button92"  type="button" class="btn" onclick="return addImage()" value="插入图片" />
    </span></td>
  </tr>
  <tr>
    <td height="126">&nbsp;</td>
    <td colspan="2" align="center" valign="top" class="downSide">
      <input name="button12" type="button" class="btn" onclick="return notMenu()" value="隐藏菜单" /><br />
	   <input name="button12" type="button" class="btn" onclick="return okMenu()" value="显示菜单" /><br />
	    <input name="button12" type="button" class="btn" onclick="return notOfter()" value="隐藏常用" /><br />
		 <input name="button12" type="button" class="btn" onclick="return okOfter()" value="显示常用" /><br />
		  <input name="button12" type="button" class="btn" onclick="return notFormat()" value="隐藏格式" /><br />
		   <input name="button12" type="button" class="btn" onclick="return okFormat()" value="显示格式" /></td>
  </tr>
  <tr>
    <td height="200">&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  
  <tr>
    <td height="35">&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td></td>
  </tr>
</table>
</body>
</html>
